<script>
    const form = document.getElementById('uploadForm');
    const message = document.getElementById('message');

    form.addEventListener('submit', async (e) => {
        e.preventDefault();

        const formData = new FormData(form);

        try {
            const response = await fetch('/upload', {
                method: 'POST',
                body: formData
            });

            if (response.ok) {
                const data = await response.json();
                message.innerHTML = "✔️ התמונה הועלתה בהצלחה!<br>ממתין לקבצים...";

                // הבא את רשימת הקבצים (PNG, SVG וכו')
                const res = await fetch('/list_letters');
                const files = await res.json();

                if (files.length > 0) {
                    let html = `<h3>📦 הורדת הקבצים:</h3><ul>`;
                    files.forEach(name => {
                        html += `<li><a href="/download/${name}" download>${name}</a></li>`;
                    });
                    html += `</ul>`;
                    message.innerHTML += html;
                } else {
                    message.innerHTML += "<br>לא נמצאו קבצים.";
                }

                message.style.color = 'green';
            } else {
                const errorText = await response.text();
                message.textContent = "❌ שגיאה בהעלאה: " + errorText;
                message.style.color = 'red';
                console.error(errorText);
            }
        } catch (err) {
            message.textContent = "❌ שגיאה כללית: " + err.message;
            message.style.color = 'red';
            console.error(err);
        }
    });
</script>


