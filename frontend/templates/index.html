<script>
    const form = document.getElementById('uploadForm');
    const message = document.getElementById('message');

    form.addEventListener('submit', async (e) => {
        e.preventDefault();

        const formData = new FormData(form);

        try {
            const response = await fetch('/upload', {
                method: 'POST',
                body: formData
            });

            if (response.ok) {
                const data = await response.json();
                message.innerHTML = "âœ”ï¸ ×”×ª××•× ×” ×”×•×¢×œ×ª×” ×‘×”×¦×œ×—×”!<br>×××ª×™×Ÿ ×œ×§×‘×¦×™×...";

                // ×”×‘× ××ª ×¨×©×™××ª ×”×§×‘×¦×™× (PNG, SVG ×•×›×•')
                const res = await fetch('/list_letters');
                const files = await res.json();

                if (files.length > 0) {
                    let html = `<h3>ğŸ“¦ ×”×•×¨×“×ª ×”×§×‘×¦×™×:</h3><ul>`;
                    files.forEach(name => {
                        html += `<li><a href="/download/${name}" download>${name}</a></li>`;
                    });
                    html += `</ul>`;
                    message.innerHTML += html;
                } else {
                    message.innerHTML += "<br>×œ× × ××¦××• ×§×‘×¦×™×.";
                }

                message.style.color = 'green';
            } else {
                const errorText = await response.text();
                message.textContent = "âŒ ×©×’×™××” ×‘×”×¢×œ××”: " + errorText;
                message.style.color = 'red';
                console.error(errorText);
            }
        } catch (err) {
            message.textContent = "âŒ ×©×’×™××” ×›×œ×œ×™×ª: " + err.message;
            message.style.color = 'red';
            console.error(err);
        }
    });
</script>


